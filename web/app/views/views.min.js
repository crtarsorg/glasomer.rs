function initCategoriesWithQuestions(a,b){readTextFile("app/static/questions.json",function(c){var d=JSON.parse(c),e={};console.log(d);var f=new Categories([]);for(var g in d){var h=new Questions([]);for(var i in d[g]){var j=d[g][i].question,i=getQuestion(j,["Slažem se","Ne slažem se","Nemam stav"]);h.push(i)}var k=new Category({name:g,questions:h});f.push(k)}console.log(e);var l=JSON.stringify(f.toJSON());a.html(b({categories:JSON.parse(l)}))})}function readTextFile(a,b){var c=new XMLHttpRequest;c.overrideMimeType("application/json"),c.open("GET",a,!0),c.onreadystatechange=function(){4===c.readyState&&"200"==c.status&&b(c.responseText)},c.send(null)}function getQuestion(a,b){var c=getAnswers(b);return new Question({text:a,possibleAnswers:c})}function getAnswers(a){for(var b=new Answers([]),c=0;c<a.length;c++){var d=new Answer({text:a[c],value:a[c].toLowerCase()});b.push(d)}return b}window.QuestionnaireView=Backbone.View.extend({template:JST["app/templates/questionnaire.hbs"],initialize:function(){this.render()},render:function(){return initCategoriesWithQuestions($(this.el),this.template),Handlebars.registerHelper("setIndex",function(a){this.name=a}),this},events:{"click #btn_save":"dataHandler","change #category":"categorySwitch"},dataHandler:function(){var a={name:"Endrit"},b=[];$(".question").each(function(){var c=$(this).find("div").find("h2").text().trim(),d=$("input[name='"+c+"']:checked").prop("value");a[c]=d,b.push(d)}),-1!=b.indexOf(void 0)&&alert("You must fill all of the fields to continue.!");new ResultView({el:$("#container")})},categorySwitch:function(){var a=$("#category").val();$(".categories").each(function(){$(this).attr("id")==a?$(this).css("display","block"):$(this).css("display","none")})}}),window.ResultView=Backbone.View.extend({template:JST["app/templates/results.hbs"],initialize:function(){this.render()},render:function(){$(this.el).html(this.template({options:[{name:"endriti"}]}))}});